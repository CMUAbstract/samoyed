#include "msp430.h"

#include <math.h>
#include <stdint.h>
#include <stdbool.h>

#include <libdsp/DSPLib.h>

/* Input signal parameters */
#define SAMPLES             64

/* Input signal and FFT result */
DSPLIB_DATA(input,MSP_ALIGN_FFT_Q15(SAMPLES))
_q15 input[SAMPLES] = {
_Q15(0.000244140625),_Q15(0.000244140625),_Q15(0.181884765625),_Q15(0.5576171875),_Q15(0.148193359375),_Q15(0.195556640625),_Q15(0.506103515625),_Q15(0.4765625),_Q15(0.000244140625),_Q15(0.27197265625),_Q15(0.6396484375),_Q15(0.1513671875),_Q15(0.093505859375),_Q15(0.297607421875),_Q15(0.487060546875),_Q15(0.001220703125),_Q15(0.24609375),_Q15(0.5517578125),_Q15(0.239013671875),_Q15(0.000244140625),_Q15(0.44091796875),_Q15(0.487060546875),_Q15(0.137451171875),_Q15(0.279052734375),_Q15(0.52392578125),_Q15(0.241943359375),_Q15(0.0419921875),_Q15(0.35498046875),_Q15(0.5107421875),_Q15(0.06298828125),_Q15(0.10986328125),_Q15(0.51611328125),_Q15(0.311279296875),_Q15(0.07861328125),_Q15(0.21875),_Q15(0.59814453125),_Q15(0.157958984375),_Q15(0.1015625),_Q15(0.47021484375),_Q15(0.37890625),_Q15(0.031982421875),_Q15(0.293701171875),_Q15(0.490966796875),_Q15(0.234619140625),_Q15(0.007568359375),_Q15(0.44287109375),_Q15(0.518310546875),_Q15(0.000244140625),_Q15(0.183837890625),_Q15(0.4599609375),_Q15(0.271484375),_Q15(0.000244140625),_Q15(0.373291015625),_Q15(0.50927734375),_Q15(0.030517578125),_Q15(0.082763671875),_Q15(0.53564453125),_Q15(0.314697265625),_Q15(0.039306640625),_Q15(0.27197265625),_Q15(0.483154296875),_Q15(0.08447265625),_Q15(0.07568359375),_Q15(0.393798828125)};

void main(void)
{
	msp_status status;
	msp_mpy_q15_params mpyParams;
	msp_fft_q15_params fftParams;

	/* Disable WDT */
	WDTCTL = WDTPW + WDTHOLD;

	/* Initialize the fft parameter structure. */
	fftParams.length = SAMPLES;
	fftParams.bitReverse = true;
	fftParams.twiddleTable = msp_cmplx_twiddle_table_64_q15;

	/* Perform real FFT with fixed scaling */
	status = msp_fft_fixed_q15(&fftParams, input);
	msp_checkStatus(status);

	/* End of program. */
	__no_operation();
}
